webpackJsonp([12],{Mn4D:function(t,e){},aTXb:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("BO1k"),o=a.n(r),n=a("Dd8w"),s=a.n(n),i=a("gNfH"),l=a("W13U"),c=a("h+p8"),d=a("NYxO"),p=a("4naa"),f=a("2Uyi"),u=(a("fAxu"),a("5k2Y")),_={data:function(){var t=this,e=[];e.push({name:"待报价",data:[],size:p.PAGE_SIZE_ARR[0],total:0,page:1,offerState:2,dateStart:"",dateStartTip:"报价开始",dateEnd:"",dateEndTip:"报价结束"}),e.push({name:"待解密",size:p.PAGE_SIZE_ARR[0],data:[],total:0,page:1,offerState:3,dateStart:"",dateStartTip:"解密开始",dateEnd:"",dateEndTip:"解密结束"}),e.push({name:"已解密",size:p.PAGE_SIZE_ARR[0],total:0,page:1,data:[],offerState:4});var a=this;return{id:this.$route.params.id,disabledRecoke:!1,modal_revoke:!1,form_revoke:{password:""},modal_decrypt:!1,form_decrypt:{password:"",pw:""},modal_pw:!1,form_offter:{password:"",pw:""},validate_offter:{password:[{required:!0,message:"设置密码不能为空",trigger:"blur"},{type:"string",min:6,message:"6-20位英文（区分大小写）、数字、字符的组合",trigger:"blur"}],pw:[{required:!0,message:"重复密码不能为空",trigger:"blur"},{validator:function(t,e,r){e!==a.form_offter.password?r(Error("密码和重复密码输入不一致")):r()},trigger:"blur"}]},modal_sub:!1,form_sub:{password:""},modal_offter_set:{bool:!1,item:{},value:""},active:0,PAGE_SIZE_ARR:p.PAGE_SIZE_ARR,tables:e,project_class:{},project_type:{},project_type2:{},project_type3:{},timeOut:"",date_show:"",date_tip:"",table_th:[{type:"selection",width:60,align:"center"},{title:"价格",key:"price",render:function(e,a){var r=e("span",{class:"text--red "},a.row.price);return 2==a.row.offerState&&(r=e("a",{style:{display:"block",minWidth:"100%",minHeight:"30px","text-align":"center"},on:{click:function(e){var r=t,o=Number(a.row.price);o="NaN"==String(o)?"":o,e.target.innerHTML="<input type='text' style='width:100%' value ='"+o+"'>";var n=e.target.querySelector("input");!function(t,e){var a=String(e).length;if(t.setSelectionRange)t.focus(),t.setSelectionRange(a,a);else if(t.createTextRange){var r=t.createTextRange();r.collapse(!0),r.moveEnd("character",a),r.moveStart("character",a),r.select()}}(n,o),n.addEventListener("blur",function(){var t=Number(this.value);(t=t.toFixed(2))<0&&(r.$Message.warning({content:"报价必须为数字且不能为小于0"}),t=a.row.price),t!=r.tables[0].data[a.index].price?(r.tables[0].data[a.index].price=t,r.setCheckoutTr()):e.target.innerHTML=t})}}},a.row.price)),r}},{title:"注册证编号",key:"registerCardNo",render:function(e,a){return e("a",{on:{click:function(){t.clickLinkGoToBack(),t.$router.push({name:"产品公示",params:{id:a.row.productId}})}}},a.row.registerCardNo)}},{title:"组件名称",key:"subGroupName"},{title:"产品转换比",key:"conversionRatio"},{title:"最小使用单位",key:"minUnit"},{title:"包装单位",key:"packUnit"},{title:"型号",key:"model"},{title:"规格",key:"standard"},{title:"分组",key:"aup2ProjectTypeGroupName"},{title:"质量层次",key:"qualityName"}]}},computed:s()({},Object(d.c)(["offterConfig"]),{table_now:function(){return this.tables[this.active]},filter:function(){var t=this;return[{data:"registerCardNo",name:"注册证编号",type:"string"},{data:"subGroupName",name:"组件名称",type:"string"},{data:"manufactureName",name:"生产企业",type:"string"},{data:"conversionRatio",name:"产品转换比",type:"string"},{data:"minUnit",name:"最小使用单位",type:"string"},{data:"packUnit",name:"包装单位",type:"string"},{data:"standard",name:"规格",type:"string"},{data:"model",name:"型号",type:"string"},{data:"aup2ProjectTypeId",name:"请选择分类目录",type:"select",options:this.project_class,onChange:function(e){e&&t.typegroupAndAttibuteListByGrouptypeId({groupTypeId:e}).then(function(e){var a={0:"全部"},r=!0,n=!1,s=void 0;try{for(var i,l=o()(e.content.subGroupList);!(r=(i=l.next()).done);r=!0){var c=i.value;a[c.id]=c.name}}catch(t){n=!0,s=t}finally{try{!r&&l.return&&l.return()}finally{if(n)throw s}}t.project_type2=a})}},{data:"managementType",name:"请选择管理类别",type:"select",options:this.project_type},{data:"aup2ProjectTypeGroupId",name:"请选择竞价组",type:"select",options:this.project_type2},{data:"qualityId",name:"请选择质量层次",type:"select",options:this.project_type3},{name:"按钮组",type:"btns",cells:[{name:"筛选",type:"filter"},{name:"重置",type:"reset"}]}]}}),methods:s()({},Object(d.b)(["groupList","manageType","subGroupId","commitOffter","offterList","revokeOffter","decryptOffter","isOffterPw","offterPw","qualityList","typegroupAndAttibuteListByGrouptypeId"]),{setCheckoutTr:function(){var t=this.$refs.table.checkout,e=this.tables[0].data,a=!0,r=!1,n=void 0;try{for(var s,i=o()(e);!(a=(s=i.next()).done);a=!0){s.value._checked=!1}}catch(t){r=!0,n=t}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}for(var l=0;l<t.length;l++){var c=t[l],d=!0,p=!1,f=void 0;try{for(var u,_=o()(e);!(d=(u=_.next()).done);d=!0){var m=u.value;c.id==m.id&&(m._checked=!0,t[l]=m)}}catch(t){p=!0,f=t}finally{try{!d&&_.return&&_.return()}finally{if(p)throw f}}}},initTimeOut:function(){var t=this;this.timeOut=setInterval(function(){t.getDate()},1e3)},setDate:function(t,e){if(t>0){var a=Object(f.toTimeDate)(t);this.date_show=a}else this.timeOut&&clearInterval(this.timeOut),this.date_show="";this.date_tip=e},getDateNum:function(t){var e=new Date,a=new Date(this.table_now.dateEnd);return[new Date(this.table_now.dateStart)-e,a-e]},getDate:function(){var t=this.getDateNum(this.table_now);t[0]>0?this.setDate(t[0],this.table_now.dateStartTip):this.setDate(t[1],this.table_now.dateEndTip)},clickLinkGoToBack:function(){window.go_to_back=this.$route.path},setRowOffter:function(){var t=this.modal_offter_set,e=t.item,a=Number(t.value).toFixed(2);this.tables[0].data[e.index].price=a,t.bool=!1},tabTable:function(t){this.active=t;var e=this.tables[t];this.$refs.table.getParamData({size:e.size,page:e.page,offerState:e.offerState})},showModalContent:function(t){var e=!0,a=!1,r=void 0;try{for(var n,s=o()(t.fail);!(e=(n=s.next()).done);e=!0){n.value+"\n"}}catch(t){a=!0,r=t}finally{try{!e&&s.return&&s.return()}finally{if(a)throw r}}t.fail.length?this.$Modal.warning({content:t.fail}):this.$Message.success({content:"操作成功!"}),this.$refs.table.getData()},openOffterModal:function(){var t=this.checkedTable("报价");if(t){for(var e=!1,a=0;a<t.length;a++){var r=Number(t[a].price);if("NaN"==String(r)||r<0){e=a+1;break}}if(e)return this.$Message.warning({content:"第"+e+"项没按要求填写报价！"});this.modal_sub=!0}},subOffter:function(){var t=this,e=this.checkedTable();if(!this.form_sub.password)return this.$Message.warning({content:"请输入管理密码！"});var a={configId:this.id,password:this.form_sub.password,data:[]},r=!0,n=!1,s=void 0;try{for(var i,l=o()(e);!(r=(i=l.next()).done);r=!0){var c=i.value;a.data.push({id:c.id,price:c.price})}}catch(t){n=!0,s=t}finally{try{!r&&l.return&&l.return()}finally{if(n)throw s}}this.commitOffter(a).then(function(e){t.form_sub.password="",t.showModalContent(e.content),t.modal_sub=!1})},openDecryptModal:function(){this.checkedTable("解密")&&(this.modal_decrypt=!0)},subDecrypt:function(){var t=this,e=this.checkedTable();if(!this.form_decrypt.password)return this.$Message.warning({content:"请输入管理密码！"});var a={configId:this.id,password:this.form_decrypt.password};a.ids=e.map(function(t){return t.id}).join(","),this.decryptOffter(a).then(function(e){t.form_decrypt.password="",t.showModalContent(e.content),t.modal_decrypt=!1})},openRevoke:function(){this.checkedTable("撤回").length&&(this.modal_revoke=!0)},subRevokeOffter:function(){var t=this,e=this.checkedTable();if(!this.form_revoke.password)return this.$Message.warning({content:"请输入管理密码！"});var a={configId:this.id,password:this.form_revoke.password};a.ids=e.map(function(t){return t.id}).join(","),this.revokeOffter(a).then(function(e){t.form_revoke.password="",t.showModalContent(e.content),t.modal_revoke=!1})},subPw:function(){var t=this;this.$refs.form.validate().then(function(e){e&&t.offterPw(t.form_offter).then(function(e){t.$Message.success({content:e.content}),t.modal_pw=!1})})},initTable:function(t){t.offerState||(t.offerState=this.tables[0].offerState);for(var e=0;e<this.tables.length;e++){var a=this.tables[e];if(t.offerState==a.offerState){this.active!=e&&(this.active=e);break}}this.timeOut&&clearInterval(this.timeOut),this.initTimeOut();var r=this.table_now;r.size=t.size,0==t.managementType&&(t.managementType=""),0==t.aup2ProjectTypeGroupId&&(t.aup2ProjectTypeGroupId=""),0==t.aup2ProjectTypeId&&(t.aup2ProjectTypeId=""),0==t.qualityId&&(t.qualityId=""),t.configId=this.id,this.offterList(t).then(function(t){r.total=t.content.total,r.data=t.content.records,r.page=t.content.page})},checkedTable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"设置",e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.$refs.table.checkout;return a.length?e&&a.length>e?(this.$Message.warning({content:"只能选择一个对象进行"+t+"！"}),!1):a:(this.$Message.warning({content:"请选择要"+t+"的对象！"}),!1)}}),created:function(){var t=this;this.$store.dispatch("apply/categories").then(function(e){t.project_class=e.content.auctionGroup,t.project_class[0]="全部"}),this.manageType().then(function(e){t.project_type={0:"全部"};var a=!0,r=!1,n=void 0;try{for(var s,i=o()(e.content);!(a=(s=i.next()).done);a=!0){var l=s.value;t.project_type[l.code]=l.text}}catch(t){r=!0,n=t}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}}),this.qualityList().then(function(e){t.project_type3={0:"全部"};var a=!0,r=!1,n=void 0;try{for(var s,i=o()(e.content);!(a=(s=i.next()).done);a=!0){var l=s.value;t.project_type3[l.code]=l.text}}catch(t){r=!0,n=t}finally{try{!a&&i.return&&i.return()}finally{if(r)throw n}}}),this.isOffterPw().then(function(e){e.content||(t.modal_pw=!0)}),this.offterConfig&&(this.tables[0].dateStart=this.offterConfig.offerStart,this.tables[0].dateEnd=this.offterConfig.offerEnd,this.tables[1].dateStart=this.offterConfig.decryptStart,this.tables[1].dateEnd=this.offterConfig.decryptEnd)},components:{TopToolBar:i.a,TablePage:l.a,FormGroup:c.a,MyModal:u.a}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.modal_pw?t._e():a("top-tool-bar",{staticClass:"title--bg",attrs:{title:"报价管理"}},[a("span",{attrs:{slot:"content"},slot:"content"},[a("strong",{staticClass:"help"},[t._v("说明")]),t._v(" "),a("p",[t._v("\n          无\n          ")])]),t._v(" "),t.date_show?a("big",{attrs:{slot:"btn"},slot:"btn"},[t._v("\n          距"+t._s(t.date_tip)+"还剩：\n          "),a("span",{staticClass:"text--red"},[t._v(t._s(t.date_show||"截止"))])]):t._e()],1),t._v(" "),t.modal_pw?t._e():a("div",{staticClass:"page-container"},[a("div",{staticClass:"head-tab"},t._l(t.tables,function(e,r){return a("a",{key:r,staticClass:"head-tab_btn",class:r===t.active?"active":"",on:{click:function(e){t.tabTable(r)}}},[t._v(" "+t._s(e.name)+"\n          ")])})),t._v(" "),t._m(0),t._v(" "),a("table-page",{ref:"table",attrs:{filter:t.filter,columns:t.table_th,getDataFn:t.initTable,pagerSizeArr:t.PAGE_SIZE_ARR,pagerSize:t.table_now.size,data:t.table_now.data,total:t.table_now.total,setPage:t.table_now.page,storage:"aup2org"+t.$route.path}}),t._v(" "),a("div",{staticStyle:{"margin-top":"15px"}},[0==t.active?a("Button",{attrs:{type:"primary"},on:{click:t.openOffterModal}},[t._v("提交选中的报价")]):t._e(),t._v(" "),1==t.active?a("Button",{attrs:{disabled:t.disabledRecoke,type:"primary"},on:{click:t.openRevoke}},[t._v("撤回")]):t._e(),t._v(" "),1==t.active?a("Button",{on:{click:t.openDecryptModal}},[t._v("解密")]):t._e()],1)],1),t._v(" "),a("my-modal",{attrs:{required:!0,title:"初次使用请先设置管理秘钥",width:"500"},on:{"on-close":function(e){t.$router.go(-1)},"on-ok":t.subPw},model:{value:t.modal_pw,callback:function(e){t.modal_pw=e},expression:"modal_pw"}},[a("ul",{staticClass:"text--red list--ol",staticStyle:{"margin-top":"20px"}},[a("li",[t._v("\n         警告：请您务必记住设置的秘钥，如果丢失或遗忘，则无法将其恢复。 \n        ")]),t._v(" "),a("li",[t._v("\n          注意：设置的管理秘钥用于：报价加密和报价解密！将直接影响入围资格。\n        ")])]),t._v(" "),a("Form",{ref:"form",staticStyle:{"margin-top":"20px"},attrs:{model:t.form_offter,rules:t.validate_offter,"label-width":70}},[a("FormItem",{staticClass:"form--padding",attrs:{label:"设置密码",prop:"password"}},[a("Input",{style:{width:"200px"},attrs:{type:"password"},model:{value:t.form_offter.password,callback:function(e){t.$set(t.form_offter,"password",e)},expression:"form_offter.password"}}),t._v(" "),a("span",{staticClass:"input-tip"},[t._v("\n            6-20位英文（区分大小写）、数字、字符的组合\n          ")])],1),t._v(" "),a("FormItem",{staticClass:"form--padding",attrs:{label:"重复密码",prop:"pw"}},[a("Input",{style:{width:"200px"},attrs:{type:"password"},model:{value:t.form_offter.pw,callback:function(e){t.$set(t.form_offter,"pw",e)},expression:"form_offter.pw"}}),t._v(" "),a("span",{staticClass:"input-tip"},[t._v("\n            请再次输入\n          ")])],1)],1)],1),t._v(" "),a("my-modal",{attrs:{title:"加密密码请输入您设置的管理秘钥",width:"500"},on:{"on-close":function(e){t.modal_sub=!1},"on-ok":t.subOffter},model:{value:t.modal_sub,callback:function(e){t.modal_sub=e},expression:"modal_sub"}},[a("ol",{staticClass:"text--red list--ol",staticStyle:{"margin-top":"15px"}},[a("li",[t._v("\n         请您务必记住设置的秘钥，如果丢失或遗忘，则无法将其恢复。 \n        ")]),t._v(" "),a("li",[t._v("\n          设置的管理秘钥用于：报价加密和报价解密！将直接影响入围资格。\n        ")]),t._v(" "),a("li",[t._v("\n          密码是区分大小写的\n        ")])]),t._v(" "),a("Form",{ref:"offter",staticStyle:{"margin-top":"15px"},attrs:{model:t.form_sub,"label-width":70}},[a("FormItem",{staticClass:"form--padding",attrs:{label:"加密密码",prop:"password"}},[a("Input",{style:{width:"200px"},attrs:{type:"password"},model:{value:t.form_sub.password,callback:function(e){t.$set(t.form_sub,"password",e)},expression:"form_sub.password"}}),t._v(" "),a("span",{staticClass:"input-tip"},[t._v("\n           请输入密码\n          ")])],1)],1)],1),t._v(" "),a("my-modal",{attrs:{title:"解密请使用设置好的管理秘钥",width:"500"},on:{"on-close":function(e){t.modal_decrypt=!1},"on-ok":t.subDecrypt},model:{value:t.modal_decrypt,callback:function(e){t.modal_decrypt=e},expression:"modal_decrypt"}},[a("ol",{staticClass:"text--red list--ol",staticStyle:{"margin-top":"20px"}},[a("li",[t._v("\n        如果您设置的密码包含大写字母，请用同样的方式输入。\n        ")]),t._v(" "),a("li",[t._v("\n         如果密码被丢失或遗忘，则无法进行撤回。\n        ")]),t._v(" "),a("li",[t._v("\n        确认后请到待报价页面中重新提交报价，请谨慎操作。\n        ")])]),t._v(" "),a("Form",{ref:"decrypt",staticStyle:{"margin-top":"15px"},attrs:{model:t.form_decrypt,"label-width":70}},[a("FormItem",{staticClass:"form--padding",attrs:{label:"加密密码",prop:"password"}},[a("Input",{style:{width:"200px"},attrs:{type:"password"},model:{value:t.form_decrypt.password,callback:function(e){t.$set(t.form_decrypt,"password",e)},expression:"form_decrypt.password"}}),t._v(" "),a("span",[t._v("\n            请输入密码\n          ")])],1)],1)],1),t._v(" "),a("my-modal",{attrs:{title:"加密密码请输入您设置的管理秘钥",width:"500"},on:{"on-close":function(e){t.modal_revoke=!1},"on-ok":t.subRevokeOffter},model:{value:t.modal_revoke,callback:function(e){t.modal_revoke=e},expression:"modal_revoke"}},[a("ol",{staticClass:"text--red list--ol",staticStyle:{"margin-top":"20px"}},[a("li",[t._v("\n        如果您设置的密码包含大写字母，请用同样的方式输入。\n\n        ")]),t._v(" "),a("li",[t._v("\n         如果密码被丢失或遗忘，则无法进行撤回。\n        ")]),t._v(" "),a("li",[t._v("\n        确认后请到待报价页面中重新提交报价，请谨慎操作。\n        ")])]),t._v(" "),a("Form",{ref:"offter",staticStyle:{"margin-top":"15px"},attrs:{model:t.form_revoke,"label-width":70}},[a("FormItem",{staticClass:"form--padding",attrs:{label:"加密密码",prop:"password"}},[a("Input",{style:{width:"200px"},attrs:{type:"password"},model:{value:t.form_revoke.password,callback:function(e){t.$set(t.form_revoke,"password",e)},expression:"form_revoke.password"}}),t._v(" "),a("span",{staticClass:"input-tip"},[t._v("\n           请输入密码\n          ")])],1)],1)],1),t._v(" "),a("my-modal",{attrs:{title:"设置报价",width:"500"},on:{"on-close":function(e){t.modal_offter_set.bool=!1},"on-ok":t.setRowOffter},model:{value:t.modal_offter_set.bool,callback:function(e){t.$set(t.modal_offter_set,"bool",e)},expression:"modal_offter_set.bool"}},[a("Form",{ref:"decrypt",staticStyle:{"margin-top":"30px"},attrs:{"label-width":70}},[a("FormItem",{staticClass:"form--padding",attrs:{label:"设置报价"}},[a("Input",{style:{width:"200px"},attrs:{type:"text"},model:{value:t.modal_offter_set.value,callback:function(e){t.$set(t.modal_offter_set,"value",e)},expression:"modal_offter_set.value"}}),t._v(" "),a("span",[t._v("\n            设置金额\n          ")])],1)],1)],1)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"head-top"},[a("p",{staticClass:"text--red"},[t._v("温馨提示: ")]),t._v(" "),a("ol",[a("li",[t._v("\n            企业报价通过网上统一解密，在规定时间内未报价或报价为0或未解密报价的，则视为自动放弃入围资格。\n          ")]),t._v(" "),a("li",[t._v("\n            生产企业本次报价的产品规格品种必须齐全，满足采购目录中的规格要求。\n          ")]),t._v(" "),a("li",[t._v("\n            原则上同一注册证下的所有型号、规格的耗材产品均应按照竟价组规则参与谈判报价,不报价的规格不予采购，选择性报价的将取消所有产品的入围和入选资格。\n          ")]),t._v(" "),a("li",{staticClass:"text--red"},[t._v("\n            报价使用货币及单位：人民币（元），报价保留小数点后2位（即：0.01），如果超出小数点后2位，则舍去。\n           ")]),t._v(" "),a("li",[t._v("\n              请按最小使用单位（既：最小包装单位）报价。\n            ")]),t._v(" "),a("li",[t._v("\n              每页报价完后必须点击“提交本页报价\n            ")])])])}]};var v=a("VU/8")(_,m,!1,function(t){a("Mn4D")},null,null);e.default=v.exports}});