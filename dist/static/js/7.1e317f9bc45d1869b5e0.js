webpackJsonp([7],{Boqd:function(t,e){},UfVZ:function(t,e){},WIyC:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("//Fk"),o=i.n(a),l=i("BO1k"),s=i.n(l),n=i("d7EF"),r=i.n(n),c=i("W3Iv"),u=i.n(c),d=i("mvHQ"),p=i.n(d),f=i("Dd8w"),h=i.n(f),v=i("gNfH"),m=i("uL18"),g=(i("2Uyi"),i("NYxO")),_={name:"product",created:function(){this.getFilterDate(),this.fetchData(),this.fetchCategory(),this.getQualityList()},components:{TopToolBar:v.a,Loading:m.a},data:function(){var t=this,e=[10,20,30,40];return{loading:!1,modalZip:{bool:!1,content:{},showAll:!1,defule:"10"},disabledApply:!1,exeFileState:!1,zipFileState:!1,pldelState:!1,pladdState:!1,filter:{registerCardNo:"",productName:"",orgName:"",productType:"",status:"",page:1,size:e[0],qualityId:""},columns:[{type:"selection",width:60,align:"center"},{title:"产品名称",key:"productName",align:"center"},{title:"生产企业",key:"orgInfoName",align:"center"},{title:"注册证编号",key:"registerCardNo",align:"center",render:function(t,e){return t("router-link",{props:{to:"/ma1/registration/"+e.row.registerCardId}},e.row.registerCardNo)}},{title:"组件名称",key:"subGroupName",align:"center",render:function(t,e){return t("router-link",{props:{to:"/LCSB/LCSB004/page/"+e.row.subGroupId}},e.row.subGroupName)}},{title:"规格",key:"standard",width:80,align:"center",render:function(t,e){return t("router-link",{props:{to:"/LCSB/LCSB005/page/"+e.row.id}},e.row.standard)}},{title:"型号",key:"model",width:80,align:"center",render:function(t,e){return t("router-link",{props:{to:"/LCSB/LCSB005/page/"+e.row.id}},e.row.model)}},{title:"分组",key:"aup2ProjectTypeGroupName",align:"center"},{title:"质量层次",key:"aup2ProjectTypeQualityName",align:"center"},{title:"审核状态",key:"auditStatus",align:"center",render:function(e,i){return e("span",{},t.handleFormatStatus(i.row.auditStatus))}}],localDataSource:[],categories:[],qualityLists:[],selection:[],total:0,pageSizeArray:e,profile:{show:!1,status:"",fileId:""},qualifications:{show:!1,status:"",fileId:""}}},computed:h()({},Object(g.c)(["pageModel"]),{storage:function(){return this.pageModel.firstMenuId+"_page"},token:function(){var t=sessionStorage.getItem("_token");return JSON.parse(t).accessToken}}),methods:h()({},Object(g.b)(["submitProductApply","qualityList"]),{getFilterDate:function(){var t=sessionStorage.getItem(this.storage);"1"==sessionStorage.getItem("produceState")?(this.filter.registerCardNo="",this.filter.productName="",this.filter.orgName="",this.filter.productType="",this.status=""):null!=t&&(this.filter=JSON.parse(t))},fetchData:function(t){var e=this;t&&(this.filter.page=1),this.loading=!0,this.$store.dispatch("apply/find",this.filter).then(function(t){e.loading=!1,t.success&&(e.localDataSource=t.content.records,e.total=t.content.total,sessionStorage.setItem(e.storage,p()(e.filter)))})},fetchCategory:function(){var t=this;this.$store.dispatch("apply/categories").then(function(e){if(e.success&&e.content){var i=u.a,a=e.content.auctionGroup,o=[{label:"全部",value:""}],l=!0,n=!1,c=void 0;try{for(var d,p=s()(i(a));!(l=(d=p.next()).done);l=!0){var f=d.value,h=r()(f,2),v=h[0],m=h[1];o.push({label:m,value:v})}}catch(t){n=!0,c=t}finally{try{!l&&p.return&&p.return()}finally{if(n)throw c}}t.categories=o}})},initQualityList:function(t){if(null!=t){var e=u.a,i=[{label:"全部",value:""}],a=!0,o=!1,l=void 0;try{for(var n,c=s()(e(t));!(a=(n=c.next()).done);a=!0){var d=n.value,p=r()(d,2),f=(p[0],p[1]);i.push({label:f.text,value:f.code})}}catch(t){o=!0,l=t}finally{try{!a&&c.return&&c.return()}finally{if(o)throw l}}this.qualityLists=i}},getQualityList:function(){var t=this;return this.qualityList().then(function(e){return t.initQualityList(e.content),t.loading=!1,o.a.resolve(e)},function(e){return t.loading=!1,o.a.reject(res)})},handleFormatStatus:function(t){switch(parseInt(t,10)){case 1:return"未提交";case 2:return"待审核";case 3:return"审核中";case 5:return"未通过";case 4:return"审核通过"}},handleReset:function(){this.filter={registerCardNo:"",productName:"",orgName:"",productType:"",status:"",page:1,size:10},this.fetchData()},handleSelection:function(t){this.selection=t.map(function(t){return t.id})},handleRemove:function(){var t=this;this.selection.length>0?this.$Modal.confirm({title:"批量删除产品",content:"确定删除吗？此操作不可逆",okText:"确定",cancelText:"取消",onOk:function(){t.$store.dispatch("apply/remove",{ids:t.selection.join(",")}).then(function(e){e.success&&(t.selection=[],t.fetchData())})}}):this.$Message.warning("请选择要删除的申报信息")},handleApply:function(){var t=this;if(!this.selection.length)return this.$Message.error("请选择要申报的产品");this.disabledApply=!0;var e={ids:this.selection.join(","),isSubmitZcz:""};this.submitProductApply(e).then(function(i){t.disabledApply=!1,i.content.suc?(t.$Message.success("产品申报成功"),t.fetchData()):t.$Modal.confirm({title:"重要提示",content:i.content.msg,onOk:function(){t.subAllId(e)}})},function(e){t.disabledApply=!1})},subAllId:function(t){var e=this;this.disabledApply=!0,t.isSubmitZcz=1,this.submitProductApply(t).then(function(t){e.$Message.success("产品申报成功"),e.fetchData(),e.disabledApply=!1},function(t){e.disabledApply=!1})},handlePager:function(t){this.filter.page=t,this.fetchData()},handlePageSize:function(t){this.filter.size=t,this.fetchData()},handleComplete:function(t){t&&(t.success?(this.profile.fileId=t.content.id,this.$Message.success("上传成功")):this.$Message.error(t.errmsg))},handleSuccess:function(t){t&&(t.success?(this.qualifications.fileId=t.content.id,this.$Message.success("上传成功")):this.$Message.error(t.errmsg))},handleSaveProfile:function(){var t=this;this.profile.fileId?(this.exeFileState=!0,this.$store.dispatch("apply/uploadExcel",{fileId:this.profile.fileId}).then(function(e){e.success&&(t.$refs.profile.clearFiles(),t.profile.fileId="",t.$Message.success("导入成功"),t.profile.fileId="",t.fetchData(),t.profile.show=!1),t.exeFileState=!1})):this.$Message.warning("请上传文件")},handleSaveQualifications:function(){var t=this;this.qualifications.fileId?(this.zipFileState=!0,this.$store.dispatch("apply/uploadZIP",{fileId:this.qualifications.fileId}).then(function(e){if(e.success){t.qualifications.show=!1;var i=e.content;t.$refs.qualifications.clearFiles(),t.qualifications.fileId="",t.modalZip.bool=!0,t.modalZip.showAll=!1,t.modalZip.content=i,t.fetchData()}t.zipFileState=!1})):this.$Message.warning("请上传文件")},zipRemove:function(t,e){this.qualifications.fileId=""},excelRemove:function(t,e){this.profile.fileId=""},zipLength:function(){if(this.qualifications.fileId)return this.$Message.warning("zip文件只允许上传一个"),!1},excelLength:function(){if(this.profile.fileId)return this.$Message.warning("excel文件只允许上传一个"),!1},handleFormatError:function(t){this.$Message.warning("请上传zip格式附件")},handleFormatErrorExcel:function(t){this.$Message.warning("请上传Excel格式附件")},handleExceededSize:function(){this.$Message.warning("附件不得大于5M")}})},y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Loading",{attrs:{loading:t.loading}}),t._v(" "),i("top-tool-bar",{attrs:{title:"产品申报"}},[i("span",{attrs:{slot:"btn"},slot:"btn"},[i("Button",{attrs:{type:"primary"},on:{click:function(e){t.profile.show=!0,t.qualifications.show=!1}}},[t._v("批量导入基本信息")]),t._v(" "),i("Button",{attrs:{type:"primary"},on:{click:function(e){t.profile.show=!1,t.qualifications.show=!0}}},[t._v("批量导入资质文件")])],1),t._v(" "),i("span",{attrs:{slot:"content"},slot:"content"},[i("strong",{staticClass:"help"},[t._v("说明")]),t._v(" "),i("p",[t._v("\n       产品申报包括注册证、组件、单一规格的申报，\n        "),i("br"),t._v("\n        条件筛选不同状态的申报产品如：\n   "),i("br"),t._v("\n        未提交、待提交或审\n       核通过等~\n      ")])])]),t._v(" "),i("div",{staticClass:"page-container"},[i("div",{staticClass:"filter-tools"},[i("Form",{ref:"filterForm",attrs:{model:t.filter,inline:""}},[i("FormItem",[i("Input",{attrs:{type:"text",placeholder:"注册证编号"},model:{value:t.filter.registerCardNo,callback:function(e){t.$set(t.filter,"registerCardNo",e)},expression:"filter.registerCardNo"}})],1),t._v(" "),i("FormItem",[i("Input",{attrs:{type:"text",placeholder:"产品名称"},model:{value:t.filter.productName,callback:function(e){t.$set(t.filter,"productName",e)},expression:"filter.productName"}})],1),t._v(" "),i("FormItem",[i("Input",{attrs:{type:"text",placeholder:"生产企业"},model:{value:t.filter.orgName,callback:function(e){t.$set(t.filter,"orgName",e)},expression:"filter.orgName"}})],1),t._v(" "),i("FormItem",[i("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择产品分类"},model:{value:t.filter.productType,callback:function(e){t.$set(t.filter,"productType",e)},expression:"filter.productType"}},t._l(t.categories,function(e){return i("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1),t._v(" "),i("FormItem",[i("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择审核状态",labelInValue:!0},model:{value:t.filter.status,callback:function(e){t.$set(t.filter,"status",e)},expression:"filter.status"}},[i("Option",{attrs:{value:""}},[t._v("全部")]),t._v(" "),i("Option",{attrs:{value:"1"}},[t._v("未提交")]),t._v(" "),i("Option",{attrs:{value:"2"}},[t._v("待审核")]),t._v(" "),i("Option",{attrs:{value:"3"}},[t._v("审核中")]),t._v(" "),i("Option",{attrs:{value:"5"}},[t._v("未通过")]),t._v(" "),i("Option",{attrs:{value:"4"}},[t._v("审核通过")])],1)],1),t._v(" "),i("FormItem",[i("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择质量层次"},model:{value:t.filter.qualityId,callback:function(e){t.$set(t.filter,"qualityId",e)},expression:"filter.qualityId"}},t._l(t.qualityLists,function(e){return i("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1),t._v(" "),i("FormItem",[i("Button",{attrs:{type:"primary"},on:{click:function(e){t.fetchData(1)}}},[t._v("筛选")]),t._v(" "),i("Button",{on:{click:function(e){t.handleReset()}}},[t._v("重置")])],1)],1)],1),t._v(" "),i("Table",{ref:"selection",attrs:{border:"",columns:t.columns,data:t.localDataSource,size:"small"},on:{"on-selection-change":t.handleSelection}}),t._v(" "),i("div",{staticClass:"pager"},[i("Page",{attrs:{current:t.filter.page,total:t.total,"show-elevator":!0,"show-sizer":!0,"show-total":!0,"page-size":t.filter.size,"page-size-opts":t.pageSizeArray},on:{"on-change":t.handlePager,"on-page-size-change":t.handlePageSize}})],1),t._v(" "),i("div",{staticClass:"footer-tools"},[i("Button",{attrs:{type:"error"},on:{click:t.handleRemove}},[t._v("批量删除")]),t._v(" "),i("Button",{attrs:{disabled:t.disabledApply,type:"primary"},on:{click:function(e){t.handleApply()}}},[t._v("批量提交")])],1),t._v(" "),i("Modal",{attrs:{width:"600",title:"基本信息导入"},on:{"on-cancel":function(e){t.profile.show=!1}},model:{value:t.profile.show,callback:function(e){t.$set(t.profile,"show",e)},expression:"profile.show"}},[i("table",{staticClass:"info-table"},[i("tr",[i("th",{staticClass:"label"},[t._v("上传附件")]),t._v(" "),i("td",[i("Upload",{ref:"profile",attrs:{action:"/portal/pub/comm/uploadimage",headers:{accesstoken:t.token},"on-success":t.handleComplete,format:["xlsx","xls"],"on-remove":t.excelRemove,"before-upload":t.excelLength,"on-format-error":t.handleFormatErrorExcel,"on-exceeded-size":t.handleExceededSize,"max-size":5120}},[i("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"}},[t._v("浏览")])],1)],1)]),t._v(" "),i("tr",[i("th",{staticClass:"label"},[t._v("模板文件下载")]),t._v(" "),i("td",[i("a",{attrs:{href:"/aup2org/pub/宁德耗材申报导入模板V1.xlsx",target:"_blank"}},[t._v("模板下载")])])])]),t._v(" "),i("div",{staticClass:"tip"},[i("div",[i("span",{staticClass:"note"},[t._v("导入操作步骤：")])]),t._v(" "),i("ol",[i("li",[t._v("\n            点击下载模板文件\n          ")]),t._v(" "),i("li",[t._v(" 根据模板文件要求，填写相应信息并保存；")]),t._v(" "),i("li",[t._v("\n            将填写好的文件上传，系统将自动进行处理；\n          ")])])]),t._v(" "),i("template",{slot:"footer"},[i("div",{staticClass:"model-footer text-center"},[i("Button",{attrs:{type:"primary",disabled:t.exeFileState||!t.profile.fileId},on:{click:t.handleSaveProfile}},[t._v("确定")])],1)])],2),t._v(" "),i("Modal",{attrs:{width:"600",title:"资质文件导入"},on:{"on-cancel":function(e){t.qualifications.show=!1}},model:{value:t.qualifications.show,callback:function(e){t.$set(t.qualifications,"show",e)},expression:"qualifications.show"}},[i("table",{staticClass:"info-table"},[i("tr",[i("th",{staticClass:"label"},[t._v("上传附件")]),t._v(" "),i("td",[i("Upload",{ref:"qualifications",attrs:{action:"/portal/pub/comm/uploadimage",headers:{accesstoken:t.token},"on-success":t.handleSuccess,format:["zip"],"on-remove":t.zipRemove,"before-upload":t.zipLength,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleExceededSize,"max-size":102400}},[i("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"}},[t._v("浏览")])],1)],1)]),t._v(" "),i("tr",[i("th",{staticClass:"label"},[t._v("模板文件下载")]),t._v(" "),i("td",[i("a",{attrs:{href:"/aup2org/api/project/apply/downLoadExcel?accesstoken="+t.token,target:"_blank"}},[t._v("模板下载")])])])]),t._v(" "),i("div",{staticClass:"tip"},[i("div",[i("span",{staticClass:"note"},[t._v("说明及注意：")])]),t._v(" "),i("ol",[i("li",[t._v("\n            请上传文件格式为“zip”的压缩包文件，压缩包仅允许包含图片文件，不能含有文件夹，否则可能会导致导入失败。\n          ")]),t._v(" "),i("li",[t._v("压缩包内的图片格式：JPG，图片大小：不超过5MB。")]),t._v(" "),i("li",[t._v("\n            图片命名规范，请下载模板进行参考。\n          ")])])]),t._v(" "),i("template",{slot:"footer"},[i("div",{staticClass:"model-footer text-center"},[i("Button",{attrs:{disabled:!t.qualifications.fileId||t.zipFileState,type:"primary"},on:{click:t.handleSaveQualifications}},[t._v("确定")])],1)])],2),t._v(" "),i("Modal",{attrs:{width:"700",title:"资质文件导入结果"},model:{value:t.modalZip.bool,callback:function(e){t.$set(t.modalZip,"bool",e)},expression:"modalZip.bool"}},[t.modalZip.content.total?i("div",[i("h5",[t._v("导入"+t._s(t.modalZip.content.total)+"条，成功:"),i("span",{staticClass:"blue"},[t._v(t._s(t.modalZip.content.success))]),t._v("条，失败:"),i("span",{staticClass:"red"},[t._v(t._s(t.modalZip.content.fail.length))]),t._v("条。")]),t._v(" "),t.modalZip.content.fail.length?i("p",[t._v("结果如下：")]):t._e(),t._v(" "),t._l(t.modalZip.content.fail,function(e,a){return a<t.modalZip.defule||t.modalZip.showAll?i("p",{key:a},[t._v("\n            "+t._s(e)+"\n          ")]):t._e()}),t._v(" "),t.modalZip.content.fail.length>t.modalZip.defule?i("p",{staticClass:"text-center",staticStyle:{"margin-top":"15px"}},[i("Button",{attrs:{type:"info"},on:{click:function(e){t.modalZip.showAll=!t.modalZip.showAll}}},[t._v(t._s(t.modalZip.showAll?"收起":"展开"))])],1):t._e()],2):t._e(),t._v(" "),i("div",{staticClass:"model-footer",attrs:{slot:"footer"},slot:"footer"},[i("Button",{on:{click:function(e){t.modalZip.bool=!1}}},[t._v("\n            确定\n          ")])],1)])],1)],1)},staticRenderFns:[]};var b=i("VU/8")(_,y,!1,function(t){i("UfVZ"),i("Boqd")},"data-v-34fdbf62",null);e.default=b.exports}});