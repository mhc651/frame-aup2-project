webpackJsonp([2],{fZX7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),r=a("Dd8w"),o=a.n(r),s=a("gNfH"),d=a("h+p8"),l=(a("2Uyi"),a("fAxu")),u=a("NYxO"),c=a("BO1k"),p=a.n(c),m=a("4naa"),h=a("W13U"),g={data:function(){var t=this;return{PAGE_SIZE_ARR:m.PAGE_SIZE_ARR,data:[],total:0,page:1,columns:[{type:"selection",width:60,align:"center"},{title:"注册证编号",key:"registerCardNo"},{title:"注册证名称",key:"registerCardName"},{title:"产地",key:"origin",render:function(e,a){return e("span",t.type_area[a.row.origin])}},{title:"产品名称（中文）",key:"name"},{title:"组件数量",key:"groupSum"},{title:"产品数量",key:"proSum"}],project_class:{},project_type:{},type_area:{}}},computed:{filter:function(){return[{data:"registerCardNo",name:"注册证编号",type:"string"},{data:"name",name:"产品名称",type:"string"},{data:"manufactureName",name:"生产企业",type:"string"},{data:"aup2ProjectTypeId",name:"请选择分类目录",type:"select",options:this.project_class},{data:"managementType",name:"请选择管理类别",type:"select",options:this.project_type},{data:"auditStatus",name:"请选择审核状态",type:"select",options:{0:"全部",1:"待提交",2:"待审核",3:"审核中",4:"审核通过",5:"审核未通过"}},{name:"按钮组",type:"btns",cells:[{name:"筛选",type:"filter"},{name:"重置",type:"reset"}]}]}},methods:o()({},Object(u.b)(["manageType","subGroupId","deleteGroupId","regList","productAddr"]),{initTable:function(t){var e=this;0==t.managementType&&(t.managementType=""),0==t.aup2ProjectTypeGroupId&&(t.aup2ProjectTypeGroupId=""),0==t.aup2ProjectTypeId&&(t.aup2ProjectTypeId=""),0==t.auditStatus&&(t.auditStatus=""),this.regList(t).then(function(t){e.data=t.content.records,e.total=t.content.total})},getTable:function(){return this.$refs.table},errorTableChange:function(t){validateChange.length>2&&this.$Message.warning({content:"只能选择一个对象"})}}),created:function(){var t=this;this.$store.dispatch("apply/categories").then(function(e){t.project_class=e.content.auctionGroup,t.project_class[0]="全部"}),this.manageType().then(function(e){t.project_type={0:"全部"};var a=!0,i=!1,n=void 0;try{for(var r,o=p()(e.content);!(a=(r=o.next()).done);a=!0){var s=r.value;t.project_type[s.code]=s.text}}catch(t){i=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw n}}}),this.productAddr().then(function(e){var a=!0,i=!1,n=void 0;try{for(var r,o=p()(e.content);!(a=(r=o.next()).done);a=!0){var s=r.value;t.type_area[s.code]=s.text}}catch(t){i=!0,n=t}finally{try{!a&&o.return&&o.return()}finally{if(i)throw n}}})},components:{TablePage:h.a}},f={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("table-page",{ref:"table",attrs:{data:this.data,pagerSizeArr:[5,10,15,20],total:this.total,columns:this.columns,page:this.page,pageSize:5,filter:this.filter,getDataFn:this.initTable}})],1)},staticRenderFns:[]},b=a("VU/8")(g,f,!1,null,null,null).exports,v=a("5k2Y"),_={data:function(){return{id:this.$route.params.id,disabledSub:!1,disabledCommit:!1,formValidate:{registerCardNo:[{required:!0,message:"注册证不能为空",trigger:"blur"}],subGroupName:[{required:!0,message:"组件名称不为空",trigger:"blur"}],conversionRatio:[{required:!0,message:"产品转换比不能为空",trigger:"blur"},{validate:l.a.validateNum,trigger:"blur"}],minUnit:[{required:!0,message:"最小单位不为空",trigger:"blur"}],packUnit:[{required:!0,message:"包装单位不能为空",trigger:"blur"}]},detail:{},review:{},open_modal_id:!1,openValidate:""}},computed:{read:function(){return this.initData(),!this.$route.query.edit},title:function(){return this.read?"组件详情":this.id?"组件编辑":"组件新增"},backPageBtn:function(){return this.read?"返回":"取消"},formConfig:function(){var t=this,e=[],a=this.review.jpgFile;return 5==this.detail.auditStatus&&a&&(e=[{type:"string",name:"审核状态:",default:"不通过",style:{color:"#f00"}},{type:"string",name:"审核意见:",default:a||"无",class:"text-pre"}]),[{name:"所属注册证",type:"trigger",data:"registerCardNo",required:!0,placeholder:"请填写所属注册证",readonly:this.id||!1,icon:"navicon-round",fn:function(e,a){t.open_modal_id=!0,t.openValidate=a}},{name:"组件名称",type:"string",data:"subGroupName",required:!0,placeholder:"请填写组件名称",span:12,readonly:!!this.read},{name:"产品转换比",type:"string",data:"conversionRatio",required:!0,placeholder:"请填写产品转换比",span:12,readonly:!!this.read},{name:"产品材质",type:"string",data:"productMaterial",required:!1,placeholder:"请填写产品材质",span:12,readonly:!!this.read},{name:"最小使用单位",type:"string",data:"minUnit",required:!0,placeholder:"请填写最小使用单位",span:12,readonly:!!this.read},{name:"产品包装材质",type:"string",data:"productPackMaterial",required:!1,placeholder:"请填写产品包装材质",span:12,readonly:!!this.read},{name:"包装单位",type:"string",data:"packUnit",required:!0,placeholder:"请填写包装单位",span:12,readonly:!!this.read},{name:"适用范围",type:"text",data:"scope",placeholder:"请填写适用范围",readonly:!!this.read},{name:"说明书",required:!0,type:"file",data:"jpgFileList",defuld:[],action:"/portal/pub/comm/uploadimage",readonly:!!this.read,format:["jpg","jpeg","png"],maxSize:5120,maxLength:7,cell:e}]}},methods:o()({},Object(u.b)(["groupDetail","commitGroupDetail","revokeGroupId","subGroupId"]),{checkoutTable:function(){var t=this.$refs.table.getTable().$data.checkout;if(t.length>1)this.$Message.warning({content:"只能选择一种注册证"});else if(t.length){this.open_modal_id=!1;var e=t[0];this.detail.registerCardNo=e.registerCardNo,this.detail.registerCardId=e.id,this.openValidate("registerCardNo")}else this.$Message.warning({content:"请选择注册证！"})},onCommit:function(){var t=this;this.$refs.form.subForm().then(function(e){t.disabledCommit=!0,(e=JSON.parse(n()(e))).jpgFile="",e.jpgFileList.length&&(e.jpgFile=e.jpgFileList.map(function(t){return t.id}).join(",")),e.id=t.detail.id,delete e.auditStatus,t.commitGroupDetail(e).then(function(e){t.disabledCommit=!1,t.$Message.success({content:"保存成功！"}),t.id=e.content.subGroupId,t.gotoEditor()},function(e){t.disabledCommit=!1})},function(e){t.disabledCommit=!1})},onSubmit:function(){var t=this;this.disabledSub=!0;var e={ids:this.id,isSubmitZcz:""};this.subGroupId(e).then(function(a){a.content.suc?(t.$Message.success({content:"提交成功！"}),t.initData()):t.$Modal.confirm({title:"重要提示",content:a.content.msg,onOk:function(){t.subAllId(e)}}),t.disabledSub=!1},function(e){t.disabledSub=!1})},subAllId:function(t){var e=this;this.disabledSub=!0,t.isSubmitZcz=1,this.subGroupId(t).then(function(t){e.$Message.success({content:"提交成功！"}),e.disabledSub=!1,e.initData()},function(t){e.disabledSub=!1})},gotoEditor:function(t,e){var a={name:"组件详情",params:{id:this.id}};1==t?(a.query={},a.query.edit=1):2==t&&(a={name:"组件管理"}),this.$router.push(a)},revokeData:function(){var t=this;this.revokeGroupId({ids:this.id}).then(function(e){t.$Message.info("撤回回成功！"),t.gotoEditor(1),t.detail.auditStatus=1})},backPage:function(){var t=this;if(this.read)if(window.go_to_back){var e=window.go_to_back;window.go_to_back="",this.$router.push(e)}else this.$router.push({name:"产品申报"});else{if(!this.id)return this.$router.go(-1);this.$Modal.confirm({content:"取消编辑将不保存修改，确定取消吗?",onOk:function(){t.$router.go(-1)}})}},initData:function(){var t=this;this.id&&this.groupDetail({id:this.id}).then(function(e){t.detail=e.content.data,t.review=e.content.data.auditData||{}})}}),components:{TopToolBar:s.a,FormGroup:d.a,OptionTable:b,MyModal:v.a}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("top-tool-bar",{attrs:{title:t.title}},[a("span",{attrs:{slot:"btn"},slot:"btn"},[a("Button",{attrs:{type:"default"},on:{click:t.backPage}},[t._v(t._s(t.backPageBtn))]),t._v(" "),2==t.detail.auditStatus&&t.read?a("Button",{attrs:{type:"primary"},on:{click:t.revokeData}},[t._v("撤回")]):t._e(),t._v(" "),1==t.detail.auditStatus&&t.read||5==t.detail.auditStatus&&t.read?a("Button",{attrs:{type:"primary"},on:{click:function(e){t.gotoEditor(1)}}},[t._v("编辑")]):t._e(),t._v(" "),t.read&&1==t.detail.auditStatus?a("Button",{attrs:{type:"primary",disabled:t.disabledSub},on:{click:t.onSubmit}},[t._v("提交审核")]):t._e(),t._v(" "),t.read?t._e():a("Button",{attrs:{type:"primary",disabled:t.disabledCommit},on:{click:t.onCommit}},[t._v("保存")])],1),t._v(" "),a("span",{attrs:{slot:"content"},slot:"content"},[a("strong",{staticClass:"help"},[t._v("说明")]),t._v(" "),a("p",[t._v("\r\n         无\r\n        ")])])]),t._v(" "),a("div",{staticClass:"page-container"},[4==t.detail.auditStatus||5==t.detail.auditStatus?a("div",[a("h5",{staticClass:"title"},[t._v("审核结果")]),t._v(" "),a("table",{staticClass:"info-table"},[a("tr",[a("th",{staticClass:"label"},[t._v("\r\n              审核结果\r\n            ")]),t._v(" "),a("td",{attrs:{colspan:"3"}},[1==t.detail.auditStatus?a("span",[t._v("\r\n                未提交\r\n              ")]):2==t.detail.auditStatus?a("span",[t._v("\r\n                待审核\r\n              ")]):3==t.detail.auditStatus?a("span",[t._v("\r\n                审核中\r\n              ")]):4==t.detail.auditStatus?a("span",[t._v("\r\n                通过\r\n              ")]):5==t.detail.auditStatus?a("span",[t._v("\r\n                不通过\r\n              ")]):t._e()])]),t._v(" "),t.detail.auditOpinion?a("tr",[a("th",{staticClass:"label"},[t._v("\r\n              审核回复\r\n            ")]),t._v(" "),a("td",{attrs:{colspan:"3"}},[a("p",{staticClass:"text-pre"},[t._v(t._s(t.detail.auditOpinion))])])]):t._e()])]):t._e(),t._v(" "),a("h5",{staticClass:"title"},[t._v("基本资料")]),t._v(" "),a("form-group",{ref:"form",attrs:{form:t.detail,config:t.formConfig,validate:t.formValidate}})],1),t._v(" "),a("my-modal",{attrs:{title:"请选择",width:"1200"},on:{"on-close":function(e){t.open_modal_id=!1},"on-ok":t.checkoutTable},model:{value:t.open_modal_id,callback:function(e){t.open_modal_id=e},expression:"open_modal_id"}},[a("option-table",{ref:"table"})],1)],1)},staticRenderFns:[]};var S=a("VU/8")(_,y,!1,function(t){a("mirS")},"data-v-7d4c6927",null);e.default=S.exports},mirS:function(t,e){}});